#!groovy
import java.nio.file.Files

properties([disableConcurrentBuilds()])

pipeline{
	agent {
		label 'master'
	}
	triggers {pollSCM('* * * * *')}
	options {
		buildDiscarder(logRotator(numToKeepStr:'10',artifactNumToKeepStr:'10'))
		timestamps()
	}
	stages {
		stage('build'){
			steps {
				script{
                  			def output = sh(returnStdout: true, script: 'ls | grep LyskovoChat').trim()
                  			echo "Output: '${output}'"
					if(output == "LyskovoChat"){
						cd 'LyskovoChat'
						git 'pull origin main'
					}
					if(output != "LyskovoChat"){
						sh 'git clone git@github.com:MrJekso/LyskovoChat.git'
					}
					//if(Files.exists("LyskovoChat")){
					//	sh 'cd LyskovoChat'
					//	sh 'git pull origin main'
					//}else{
					//	sh 'git clone git@github.com:MrJekso/LyskovoChat.git'
					//}
				}
			}
		}
	}
}
